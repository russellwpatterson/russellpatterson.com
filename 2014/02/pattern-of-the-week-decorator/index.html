<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Russell Patterson"><meta name=description content="Russell Patterson's personal website"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pattern of the Week: Decorator"><meta name=twitter:description content="This is the second in a (hopefully) long series of &ldquo;Pattern of the Week&rdquo; posts. I&rsquo;m primarily sticking with the Gang of Four patterns, but I may branch off occasionally. Thanks for reading.
Type: Structural
Difficulty: Beginner
This week&rsquo;s &ldquo;Pattern of the Week&rdquo; is the Decorator pattern. To explain this pattern, I&rsquo;m going to start with an explanation of the Open/Closed Principle. The Open/Closed Principle is one of the five &ldquo;SOLID&rdquo; principles outlined by Robert C."><meta property="og:title" content="Pattern of the Week: Decorator"><meta property="og:description" content="This is the second in a (hopefully) long series of &ldquo;Pattern of the Week&rdquo; posts. I&rsquo;m primarily sticking with the Gang of Four patterns, but I may branch off occasionally. Thanks for reading.
Type: Structural
Difficulty: Beginner
This week&rsquo;s &ldquo;Pattern of the Week&rdquo; is the Decorator pattern. To explain this pattern, I&rsquo;m going to start with an explanation of the Open/Closed Principle. The Open/Closed Principle is one of the five &ldquo;SOLID&rdquo; principles outlined by Robert C."><meta property="og:type" content="article"><meta property="og:url" content="/2014/02/pattern-of-the-week-decorator/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-02-04T02:13:46+00:00"><meta property="article:modified_time" content="2014-02-04T02:13:46+00:00"><base href=/2014/02/pattern-of-the-week-decorator/><title>Pattern of the Week: Decorator · Russell Writes Code</title><link rel=canonical href=/2014/02/pattern-of-the-week-decorator/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.11.2/css/all.css integrity=sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.81.0"></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Russell Writes Code</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About Me</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/things-i-work-on/>Things I Work On</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Pattern of the Week: Decorator</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i><time datetime=2014-02-04T02:13:46Z>February 4, 2014</time></span>
<span class=reading-time><i class="fas fa-clock"></i>4-minute read</span></div><div class=categories><i class="fas fa-folder"></i><a href=/categories/pattern-of-the-week/>Pattern of the Week</a>
<span class=separator>•</span>
<a href=/categories/technical/>Technical</a></div></div></header><div><p><em>This is the second in a (hopefully) long series of &ldquo;Pattern of the Week&rdquo; posts. I&rsquo;m primarily sticking with the <a href="http://www.amazon.com/gp/product/B000SEIBB8/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B000SEIBB8&linkCode=as2&tag=russepatte-20">Gang of Four</a> patterns, but I may branch off occasionally. Thanks for reading.</em></p><p>Type: <strong>Structural</strong><br>Difficulty: <strong>Beginner</strong></p><p>This week&rsquo;s &ldquo;Pattern of the Week&rdquo; is the Decorator pattern. To explain this pattern, I&rsquo;m going to start with an explanation of the <a href=http://en.wikipedia.org/wiki/Open/closed_principle>Open/Closed Principle</a>. The Open/Closed Principle is one of the five &ldquo;<a href=http://en.wikipedia.org/wiki/SOLID_(object-oriented_design)>SOLID</a>&rdquo; principles outlined by Robert C. Martin in his works. The principle states that a class should be open for extension, but closed for modification. What does this mean? It&rsquo;s actually pretty simple. We shouldn&rsquo;t change the behavior of a class after it has been defined, and we should be able to extend the class by various means to add functionality. One of the ways to extend a class without modifying it is the Decorator pattern. Without further ado, here&rsquo;s a class:</p><pre><code>public class Person : IPerson
{
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public string GetFullName()
    {
        return FirstName + &quot; &quot; + LastName;
    }
}
</code></pre><p>Well, that&rsquo;s a pretty simple class. It implements the following interface:</p><pre><code>public interface IPerson
{
    string FirstName { get; set; }
    string LastName { get; set; }
    string GetFullName();
}
</code></pre><p>Nothing revolutionary there. We&rsquo;ve represented a pretty basic person. So, let&rsquo;s say we want to print out the information on the console. Here&rsquo;s one way to do it:</p><pre><code>var p = new Person();
p.FirstName = &quot;John&quot;;
p.LastName = &quot;Public&quot;;

var fullName = p.GetFullName();
Console.WriteLine(&quot;Person: {0}&quot;, fullName);
</code></pre><p>Since this only deals with the Person class, maybe we should add it to the Person class, as a Print method. But wait, wouldn&rsquo;t that be modifying the class to extend it? Yes. So, we shouldn&rsquo;t do that. Worse, it would also be violating another SOLID principle: The <a href=http://en.wikipedia.org/wiki/Single_responsibility_principle>Single Responsibility Principle</a>. This class would have the responsibility to keep Person information, as well as the responsibility to print it out to the console. Well, we don&rsquo;t want to break two SOLID principles, so let&rsquo;s try something using the Decorator pattern instead. We&rsquo;ll create the following class:</p><pre><code>public class PrintablePerson : IPerson
{
    private readonly IPerson _person;
    public PrintablePerson(IPerson p)
    {
        _person = p;
    }

    public string FirstName
    {
        get { return _person.FirstName; }
        set { _person.FirstName = value; }
    }

    public string LastName
    {
        get { return _person.LastName; }
        set { _person.LastName = value; }
    }

    public string GetFullName()
    {
        return _person.GetFullName();
    }

    public void Print()
    {
        Console.WriteLine(&quot;Person: {0}&quot;, this.GetFullName());
    }
}
</code></pre><p>Now, there are a couple of important notes about the PrintablePerson class. First of all, you&rsquo;ll notice that it implements the same interface as the Person class. It also adds a method called Print. Finally, it takes <em>any</em> implementation of IPerson in the constructor, then hands off all calls to IPerson properties and methods to that class. So, how does this help us?</p><p>Well, we can now add printing functionality to <em>any</em> IPerson implementation, without changing the class itself. This new class also has only one responsibility: printing. That covers both the Single Responsibility Principle and the Open/Closed Principle. So, let&rsquo;s look at this in action:</p><pre><code>var pp = new PrintablePerson(new Person());

pp.FirstName = &quot;John&quot;;
pp.LastName = &quot;Public&quot;;

pp.Print();
</code></pre><p>By decorating the Person class in the above code, we were able to extend the class, without actually modifying the original class. This is incredibly powerful. By using this technique, you can keep your classes simple, and make sure that they only have one responsibility. You can also avoid changing the code in a class that you know is working, so you don&rsquo;t have to worry as much about introducing bugs. (You should still test though!)</p><p>You may be asking yourself, &ldquo;that&rsquo;s good and all, but when do I use it?&rdquo; Well, there are countless ways to use the pattern. Microsoft actually uses the pattern fairly heavily in the .NET Framework, mainly with the System.IO classes. You could use it to add logging to a class that doesn&rsquo;t have it built in. You could use it to handle exceptions from a class that doesn&rsquo;t handle them. Again, the possibilities are nearly endless.</p><p>That’s all! Visit next week for an explanation of the Strategy pattern.</p><p><a href=https://github.com/rwpcpe/pattern-of-the-week/>View Sample Code</a></p></div><footer></footer></article><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js id=MathJax-script></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}}</script></section></div><footer class=footer><section class=container><p>Not a strong bowler.</p>© 2008 - 2021
Russell Patterson</section></footer></main></body></html>